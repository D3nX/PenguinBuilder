require "base64"
eval(Base64.decode64("cmVxdWlyZSAiemlwIgojIHJlcXVpcmUgImJhc2U2NCIKcmVxdWlyZSAiZmZp
IgoKcGFyYW0gPSBBUkdWWzBdCgptb2R1bGUgQkRLCglleHRlbmQgRkZJOjpM
aWJyYXJ5CglmZmlfbGliICIje0Rpci5wd2R9L2tleS5kbGwiCglhdHRhY2hf
ZnVuY3Rpb24gOmdrZXksIDpna2V5LCBbXSwgOmludAplbmQKCmRlZiBsKGJk
dmFyMSwgYmR2YXIyLCBiZHZhcjgpCgliZHZhcjcgPSAiIgoJCglpZiBub3Qg
YmR2YXIxW2JkdmFyOF0KCQliZHZhcjkgPSBmYWxzZQoJCWJkdmFyMi5lYWNo
IGRvIHxmfAoJCQlpZiBiZHZhcjFbZitiZHZhcjhdCgkJCQliZHZhcjggPSBm
K2JkdmFyOAoJCQkJYmR2YXI5ID0gdHJ1ZQoJCQkJYnJlYWsKCQkJZW5kCgkJ
ZW5kCgkJCgkJaWYgbm90IGJkdmFyOQoJCQkKCQllbmQKCWVuZAoKCWJkdmFy
MVtiZHZhcjhdLnNwbGl0KCJcbiIpLmVhY2ggZG8gfGxpbmV8CgkJaWYgbGlu
ZS5pbmNsdWRlPygicmVxdWlyZV9yZWxhdGl2ZSIpCgkJCWJkdmFyOF90b19s
b2FkID0gbGluZS5zcGxpdCgiICIpWzFdLmdzdWIoIlwiIiwgIiIpLmdzdWIo
Ii4vIiwgIiIpCgkJCWJkdmFyOF90b19sb2FkICs9ICIucmIiIGlmIG5vdCBi
ZHZhcjhfdG9fbG9hZC5pbmNsdWRlPygiLnJiIikKCgkJCWJkdmFyNyArPSBs
KGJkdmFyMSwgYmR2YXIyLCBiZHZhcjhfdG9fbG9hZCkKCQllbHNlCgkJCWJk
dmFyNyArPSBsaW5lKyJcbiIKCQllbmQKCWVuZAoJCglyZXR1cm4gYmR2YXI3
CmVuZAoKYmR2YXI4ID0gImRhdGEuZHJlIgoKYmR2YXI0ID0gSU8uYmlucmVh
ZChiZHZhcjgpLnJldmVyc2UKCmlmIEJESzo6Z2tleSgpICE9IGJkdmFyNC5z
aXplIG9yIHBhcmFtICE9IEJhc2U2NC5kZWNvZGU2NCgiUWtReU1ESXhNVGt3
T0E9PSIpCglyYWlzZSAiRXJyb3IhIgplbmQKCmJkdmFyNSA9IFN0cmluZ0lP
Lm5ldyhCYXNlNjQuZGVjb2RlNjQoYmR2YXI0KS5yZXZlcnNlKQpiZHZhcjYg
PSBaaXA6OklucHV0U3RyZWFtLm5ldyhiZHZhcjUpCgpiZHZhcjEgPSB7fQpi
ZHZhcjIgPSBbXQoKd2hpbGUgKGJkdmFyMyA9IGJkdmFyNi5nZXRfbmV4dF9l
bnRyeSkKCWlmIGJkdmFyMy5nZXRfaW5wdXRfc3RyZWFtLmlzX2E/IFppcDo6
SW5wdXRTdHJlYW0KCQoJCWlmIGJkdmFyMy5nZXRfaW5wdXRfc3RyZWFtLnJl
YWQgIT0gIiIKCQkJYmR2YXIxW2JkdmFyMy5uYW1lXSA9IGJkdmFyMy5nZXRf
aW5wdXRfc3RyZWFtLnJlYWQKCQllbHNlCgkJCWJkdmFyMiA8PCBiZHZhcjMu
bmFtZQoJCWVuZAoJZW5kCmVuZAoKaWYgbm90IGJkdmFyMVsibWFpbi5yYiJd
CglyYWlzZSAibWFpbiBub3QgZm91bmQhIgplbHNlCgliZHZhcjcgPSBsKGJk
dmFyMSwgYmR2YXIyLCAibWFpbi5yYiIpCglldmFsKGJkdmFyNykKZW5k"))